<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Black Metal</title>
<style>
  body {
    background-color: black;
    color: white;
    font-family: Arial, sans-serif;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    text-align: justify;
    text-align-last: right;
    margin: 0;
  }

  #container {
    width: 80%;
    font-size: 3vw;
    line-height: 1.3;
    transition: opacity 3s ease;
  }

  .fade-out {
    opacity: 0;
  }

  span {
    display: inline;
    transition: all 1.2s ease;
    padding: 0 4px;
  }

  .underline { text-decoration: underline; }
  .italic { font-style: italic; }
  .strike { text-decoration: line-through; }

  /* Evidenziatori */
  .highlight-red { background-color: #ff4d4d; color: white; }
  .highlight-orange { background-color: #ff944d; color: black; }
  .highlight-yellow { background-color: #ffea4d; color: black; }
  .highlight-green { background-color: #66ff66; color: black; }
  .highlight-blue { background-color: #4da6ff; color: white; }
  .highlight-purple { background-color: #b366ff; color: white; }
  .highlight-pink { background-color: #ff66cc; color: black; }
  .highlight-cyan { background-color: #4dffff; color: black; }
  .highlight-lime { background-color: #ccff33; color: black; }
  .highlight-magenta { background-color: #ff33cc; color: black; }
  .highlight-teal { background-color: #33cccc; color: white; }
  .highlight-violet { background-color: #9966ff; color: white; }

  /* Colori testo */
  .red { color: #ff3333; }
  .orange { color: #ff9933; }
  .yellow { color: #ffee33; }
  .green { color: #33ff77; }
  .blue { color: #3399ff; }
  .purple { color: #cc66ff; }
  .pink { color: #ff66b2; }
  .cyan { color: #33ffff; }
  .lime { color: #aaff33; }
  .magenta { color: #ff33cc; }
  .teal { color: #33cccc; }
  .violet { color: #9966ff; }
</style>
</head>
<body>
  <div id="container"></div>

  <script>
    const text = "La tua frase completa da generare parola per parola, lentamente, in modo animato e dinamico.";
    const words = text.split(" ");
    const container = document.getElementById("container");

    const colors = ["red","orange","yellow","green","blue","purple","pink","cyan","lime","magenta","teal","violet"];
    const highlights = ["highlight-red","highlight-orange","highlight-yellow","highlight-green","highlight-blue","highlight-purple","highlight-pink","highlight-cyan","highlight-lime","highlight-magenta","highlight-teal","highlight-violet"];
    const effects = ["underline","italic","strike",""];

    let index = 0;
    let prevColor = null;
    let wordElements = [];

    function randomItemExcept(arr, except) {
      let item;
      do { item = arr[Math.floor(Math.random() * arr.length)]; }
      while (item === except);
      return item;
    }

    function addWord() {
      if (index >= words.length) {
        setTimeout(() => fadeOut(), 6000); // rimane 6 secondi prima del fade
        return;
      }

      const span = document.createElement("span");
      span.textContent = words[index] + " ";
      span.classList.add("fade-in");

      let color = (index === 0) ? "white" : randomItemExcept(colors, prevColor);
      span.style.color = color;
      prevColor = color;

      container.appendChild(span);
      wordElements.push(span);
      index++;

      // Dopo la prima parola, parte la generazione e gli effetti
      if (index > 1) applyRandomEffects();

      const scrollHeight = container.scrollHeight;
      if (scrollHeight > window.innerHeight) {
        window.scrollTo({ top: scrollHeight - window.innerHeight, behavior: "smooth" });
      }

      setTimeout(addWord, 800); // velocità generazione parole
    }

    function applyRandomEffects() {
      wordElements.forEach(wordEl => {
        // Reset classi tranne la fade-in
        wordEl.className = "fade-in";

        const effect = effects[Math.floor(Math.random() * effects.length)];
        if (effect) wordEl.classList.add(effect);

        // Colore parola
        const newColor = randomItemExcept(colors, prevColor);
        wordEl.style.color = newColor;
        prevColor = newColor;

        // Evidenziatore randomico (30% di probabilità)
        if (Math.random() < 0.3) {
          let highlight;
          do { highlight = highlights[Math.floor(Math.random() * highlights.length)]; }
          while (highlight.includes(newColor)); // evita colori uguali
          wordEl.classList.add(highlight);
        }
      });
    }

    function fadeOut() {
      container.classList.add("fade-out");
      setTimeout(() => {
        container.classList.remove("fade-out");
        container.innerHTML = "";
        index = 0;
        wordElements = [];
        setTimeout(addWord, 1000); // nero visibile 1s in meno
      }, 4500); // fade-out più lento (4.5s)
    }

    // Avvia subito l’animazione (senza lag)
    window.onload = () => {
      addWord();
      setInterval(applyRandomEffects, 1800); // effetti più lenti
    };
  </script>
</body>
</html>
